{"version":3,"sources":["base.js"],"names":["kx","ready","list","detail","blog","error","status","response","xhr","console","version","endpoint","event","add","target","this","id","attributes","value","preventDefault","history","state","pushState","href","replace","window","location","ajax","get","url","success","Object","keys","result","forEach","key","knot","tie","style","addClass","document","querySelector","display","innerHTML","anchor","blogs","pathname","replaceState","click","onpopstate","removeClass","extension","element","model","delegation","delegated","template","createElement","propagate","appendChild","subscribe"],"mappings":"AAEAA,GAAGC,MAAM,WACR,YAEA,IAKCC,GAAMC,EAAQC,EALXC,EAAQ,SAASC,EAAQC,EAAUC,GACrCC,QAAQJ,MAAMC,EAAQC,IAEvBG,EAAU,KACVC,EAAW,QAAUD,EAAU,OAoBhCV,IAAGY,MAAMC,IAAI,gBAAiB,QAAS,eAAgB,SAASD,GAC/D,GAAIE,GAASC,KACZC,EAAKF,EAAOG,WAAW,WAAWC,KA6BnC,OA3BAN,GAAMO,mBAEDC,QAAQC,OAAU,MAAQD,SAAQC,OAASD,QAAQC,MAAML,KAAOA,IACpEI,QAAQE,WAAWN,GAAIA,GAAK,OAAQF,EAAOS,KAAKC,QAAQC,OAAOC,SAASH,KAAM,KAG/EvB,GAAG2B,KAAKC,KACPC,IAAKlB,EAAW,IAAMK,EACtBc,QAAS,SAASxB,EAAQC,EAAUC,GAC9BJ,EAIJ2B,OAAOC,KAAKzB,EAAS0B,QAAQC,QAAQ,SAASC,GAC7C/B,EAAK+B,GAAO5B,EAAS0B,OAAOE,KAJ7B/B,EAAOgC,KAAKC,IAAI9B,EAAS0B,OAAQ9B,GAQlCH,GAAGsC,MAAMC,SAASC,SAASC,cAAc,gBAAiB,UAE1DtC,EAAOmC,MAAMI,QAAU,QACvBxC,EAAKoC,MAAMI,QAAU,QAGtBrC,MAAOA,KAGD,IAGRL,GAAG2B,KAAKC,KACPC,IAAK,mBACLC,QAAS,SAASxB,EAAQC,EAAUC,GACnCgC,SAASC,cAAc,iBAAiBE,WAAapC,EAErDL,EAAOsC,SAASC,cAAc,cAC9BtC,EAASqC,SAASC,cAAc,gBAEhCtC,EAAOmC,MAAMI,QAAU,OAEvB1C,GAAG2B,KAAKC,KACPC,IAAKlB,EACLmB,QAAS,SAASxB,EAAQC,EAAUC,GACnC,GAAIoC,EAEJR,MAAKC,KAAKQ,MAAOtC,EAAS0B,QAAS/B,GAEF,MAA7BuB,OAAOC,SAASoB,UAAwG,QAAnFF,EAASJ,SAASC,cAAc,WAAahB,OAAOC,SAASoB,SAAW,SAChH1B,QAAQ2B,aAAa,KAAM,GAAI,KAC/BtB,OAAOC,SAASH,KAAO,QAGpBqB,IACHA,EAAOI,QACP9C,EAAKoC,MAAMI,QAAU,SAIvBrC,MAAOA,KAITA,MAAO,SAASC,EAAQC,EAAUC,OAKnCiB,OAAOwB,WAAa,SAASrC,GAC5B,MAAKA,GAAMS,OAAgC,gBAAhBT,GAAMS,OAAwB,MAAQT,GAAMS,MAShEmB,SAASC,cAAc,yBAA2B7B,EAAMS,MAAML,GAAK,MAAMgC,SAR/E9C,EAAKoC,MAAMI,QAAU,QACrBvC,EAAOmC,MAAMI,QAAU,OAEvB1C,GAAGsC,MAAMY,YAAYV,SAASC,cAAc,gBAAiB,WAEtD,IAMTL,KAAKe,UAAU,OAAQ,SAASC,EAASC,EAAOlB,EAAKmB,GACpD,GAAIC,GAAYD,EAAWD,EAAOlB,GACjCqB,EAAWhB,SAASiB,cAAc,OAClCC,EAAY,SAASxC,GACpBsC,EAASb,UAAYzB,EAGvBkC,GAAQO,YAAYH,GAEhBD,GACHA,EAAUK,UAAUF,GAGrBA,EAAUL,EAAMlB","file":"base.min.js","sourcesContent":["/* jshint browser:true */\n/* global kx, knot */\nkx.ready(function() {\n\t'use strict';\n\n\tvar error = function(status, response, xhr) {\n\t\t\tconsole.error(status, response);\n\t\t},\n\t\tversion = 'v1',\n\t\tendpoint = '/api/' + version + '/blog',\n\t\tlist, detail, blog;\n\n\tfunction load(type, file) {\n\t\tswitch (type) {\n\t\t\tcase 'script':\n\t\t\t\tvar script = document.createElement('script');\n\t\t\t\tscript.src = file;\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t\tbreak;\n\n\t\t\tcase 'style':\n\t\t\t\tvar style = document.createElement('link');\n\t\t\t\tstyle.rel = 'stylesheet';\n\t\t\t\tstyle.href = file;\n\t\t\t\tdocument.head.appendChild(style);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tkx.event.add('.site-content', 'click', '.blog-item a', function(event) {\n\t\tvar target = this,\n\t\t\tid = target.attributes['data-id'].value;\n\n\t\tevent.preventDefault();\n\n\t\tif (!history.state || ('id' in history.state && history.state.id !== id)) {\n\t\t\thistory.pushState({id: id}, 'test', target.href.replace(window.location.href, ''));\n\t\t}\n\n\t\tkx.ajax.get({\n\t\t\turl: endpoint + '/' + id,\n\t\t\tsuccess: function(status, response, xhr) {\n\t\t\t\tif (!blog) {\n\t\t\t\t\tblog = knot.tie(response.result, detail);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tObject.keys(response.result).forEach(function(key) {\n\t\t\t\t\t\tblog[key] = response.result[key];\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tkx.style.addClass(document.querySelector('.site-header'), '-small');\n\n\t\t\t\tdetail.style.display = 'block';\n\t\t\t\tlist.style.display = 'none';\n\t\t\t},\n\n\t\t\terror: error\n\t\t});\n\n\t\treturn false;\n\t});\n\n\tkx.ajax.get({\n\t\turl: '/template/detail',\n\t\tsuccess: function(status, response, xhr) {\n\t\t\tdocument.querySelector('.site-content').innerHTML += response;\n\n\t\t\tlist = document.querySelector('.blog-list');\n\t\t\tdetail = document.querySelector('.blog-detail');\n\n\t\t\tdetail.style.display = 'none';\n\n\t\t\tkx.ajax.get({\n\t\t\t\turl: endpoint,\n\t\t\t\tsuccess: function(status, response, xhr) {\n\t\t\t\t\tvar anchor;\n\n\t\t\t\t\tknot.tie({blogs: response.result}, list);\n\n\t\t\t\t\tif (window.location.pathname !== '/' && (anchor = document.querySelector('a[href=\"' + window.location.pathname + '\"]')) === null) {\n\t\t\t\t\t\thistory.replaceState(null, '', '/');\n\t\t\t\t\t\twindow.location.href = '/404';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (anchor) {\n\t\t\t\t\t\tanchor.click();\n\t\t\t\t\t\tlist.style.display = 'none';\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\terror: error\n\t\t\t});\n\t\t},\n\n\t\terror: function(status, response, xhr) {\n\n\t\t}\n\t});\n\n\twindow.onpopstate = function(event) {\n\t\tif (!event.state || typeof event.state !== 'object' || !('id' in event.state)) {\n\t\t\tlist.style.display = 'block';\n\t\t\tdetail.style.display = 'none';\n\n\t\t\tkx.style.removeClass(document.querySelector('.site-header'), '-small');\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn document.querySelector('.blog-item a[data-id=\"' + event.state.id + '\"]').click();\n\t};\n\n\tknot.extension('html', function(element, model, key, delegation) {\n\t\tvar delegated = delegation(model, key),\n\t\t\ttemplate = document.createElement('div'),\n\t\t\tpropagate = function(value) {\n\t\t\t\ttemplate.innerHTML = value;\n\t\t\t};\n\n\t\telement.appendChild(template);\n\n\t\tif (delegated) {\n\t\t\tdelegated.subscribe(propagate);\n\t\t}\n\n\t\tpropagate(model[key]);\n\t});\n});\n"],"sourceRoot":"/source/"}