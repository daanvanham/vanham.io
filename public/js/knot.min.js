!function(e,t){var n="JSONFormatter";"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(n,t):("object"==typeof exports?exports:e)[n]=t()}(this,function(){function e(){function t(e){return c.indexOf(e)>=0}function n(e,n){var r=s;return n||!t(e)&&!f.noquote.test(e)||(r=""),r+e+r}function r(e){return f.trailer.test(e)?r(e.substr(0,e.length-1)):e}function o(e,t){for(var r,o=[];t.length;)if(r=t.shift(),"\\"!==r[r.length-1]){if(r===e)break;o.push(r)}else f.escape.test(t[0])||(r=r.substr(0,r.length-1)),o.push(r),o.push(t.shift());return n(o.join(""))}function i(e){for(var t,i="";e.length;)switch(t=e.shift()){case" ":break;case"}":case"]":i=r(i).concat([t]);break;case'"':case"'":i+=o(t,e);break;default:i+=n(t,":"===e[0])}return i}function a(e){var n,r=[];for(n=0;n<e.length;++n)0===r.length||t(e[n])||t(r[r.length-1])?r.push(e[n]):r[r.length-1]+=e[n];return r}if("undefined"!=typeof e.prototype.__instance||!(this instanceof e))return e.prototype.__instance||new e;e.prototype.__instance=this;var u=this,c="'\":,{}[] ",s='"',f={escape:/["\\\/\b\f\n\r\t]/,noquote:/^(?:true|false|null|-?[0-9]+(?:\.[0-9]+)?)$/i,trailer:/[,]+$/};u.prepare=function(e){return i(a(e)).replace(/^.*?([:,]).*$/,function(e,t){var n=":"===t?"{}":"[]";return e[0]!==n[0]?n[0]+r(e)+n[1]:e})},u.parse=function(e){return JSON.parse(u.prepare(e))}}return e}),function(e,t){"use strict";function n(){function n(){return r()?(g=new JSONFormatter,m={defaults:{greedy:!0,attribute:"data-knot"},extension:{},rAF:e.requestAnimationFrame||function(e){setTimeout(e,16)}},document.addEventListener("DOMContentLoaded",function(){i(),m.ready=!0},!1),void t(a)):setTimeout(function(){i("Unsupported browser")},0)}function r(){var e=!0;return e=e&&"addEventListener"in document,e=e&&"defineProperties"in Object,e=e&&"getOwnPropertyDescriptor"in Object}function o(e){return Array.prototype.slice.call(e)}function i(e,t){var n=[e,E];if(t=t||m&&"ready"in m?m.ready:!1)for(var r=0;r<t.length;++r)t[r].apply(null,n);return E}function a(e,t){return t&&(m.extension[e]=t),e in m.extension?m.extension[e]:function(){console.error('Knot: Unknown extension "'+e+'"')}}function u(e){for(var t,n=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=r.nextNode();)n.push(t);return n}function c(e){var t,n,r=[];switch(e.nodeType){case 11:for(n=0;n<e.childNodes.length;++n)r=r.concat(c(e.childNodes[n]));break;case 1:e.hasAttribute(m.defaults.attribute)&&r.push(e);case 9:for(t=e.querySelectorAll("["+m.defaults.attribute+"]"),n=0;n<t.length;++n)r.push(t[n])}return r}function s(e){var t=e.nodeValue.match(/(\{([^\{]+)\})/),n=t?0===t.index?e:e.splitText(t.index):null,r=t?n.splitText(t[1].length):null,o=n?[n]:[];return n&&(n.original=n.nodeValue),r&&(o=o.concat(s(r))),o}function f(e){var t=[];return u(e).forEach(function(e){t=t.concat(s(e))}),t}function l(e){var t;if(e&&"object"==typeof e)for(t in e)m.defaults[t]=e[t];return m.defaults}function p(e){var t,n,r={prepared:{enumerable:!1,value:!0}};if("object"==typeof e&&!("prepared"in e&&e.prepared)){for(t in e)"function"==typeof e[t]&&"provider"in e[t]?"scope"in e[t]&&!e[t].scope()&&e[t].scope(e):"function"==typeof e[t]?r[t]={enumerable:!0,writable:!1,value:e[t]}:"object"!=typeof e[t]||e[t]instanceof Array?(n=h(e[t],e),r[t]={enumerable:!0,get:n,set:n}):r[t]={enumerable:!0,writable:!1,value:p(e[t])};Object.defineProperties(e,r)}return e}function d(e,t){var n,r,o=!1;if(t in e)"function"==typeof e[t]&&"element"in e[t]?o=e[t]:(n=Object.getOwnPropertyDescriptor(e,t),o=n.get);else if(r=t.indexOf("."),r>0&&t.substr(0,r)in e)return d(e[t.substr(0,r)],t.substr(r+1));return o}function h(e,t){var n=[],r=[],i=[],a=b(e),u=function(){return arguments.length?(e=u.provider(arguments[0]),a=b.apply(t,[e,n,r,"delegate"])):i.length&&i.forEach(function(t){t.apply(null,[e])}),a};return e instanceof Array&&(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].forEach(function(o){"function"==typeof e[o]&&(e["_"+o]=e[o],e[o]=function(){var i=e["_"+o].apply(e,arguments);return e.forEach(function(t,n){e[n]=p(t)}),b.apply(t,[e,n,r,o]),i})}),e.forEach(function(t,n){e[n]=p(t)})),u.provider=function(e){var o;return"function"==typeof e&&(o=e,e=function(){return b.apply(t,[o.apply(null,arguments),n,r,"function"])}),e},u.scope=function(){return!t&&arguments.length&&(t=arguments[0]),t},u.element=function(){var r;return arguments.length?(r=o(arguments),r.forEach(function(e){y(e,u)}),b.apply(t,[e,r,void 0,"element"]),n=n.concat(r),u):n},u.access=function(){return i=i.concat(o(arguments)),u},u.subscribe=function(){return r=r.concat(o(arguments)),u},u.provider(e),u}function b(t,n,r,o){var i,a="function"==typeof t?t():t,u=this;return r&&r.forEach(function(e){var t=e.apply(null,[a,u,o]);void 0!==t&&(a=t)}),n&&(i=""+a,n.forEach(function(t){i!==t.nodeValue&&m.rAF.apply(e,[function(){t.nodeValue=i}])})),"function"==typeof t?t:a}function v(e,t){var n=e(),r=typeof n;switch("object"===r&&(r=r instanceof Array?"array":r),r){case"function":n!==t&&e(t);break;case"number":+n!==+t&&e(+t);break;case"boolean":!!n!=!!t&&e(!!t);break;case"string":default:n!==t&&e(t)}}function y(t,n){var r;"observer"in m||(m.observer=e.MutationObserver||e.webkitMutationObserver||!1,m.textObserverConfig={characterData:!0,characterDataOldValue:!0}),m.observer?(r=new m.observer(function(e){e.forEach(function(e){v(n,e.target.nodeValue)})}),r.observe(t,m.textObserverConfig)):t.addEventListener&&t.addEventListener("DOMCharacterDataModified",function(e){e.newValue&&v(n,e.newValue)})}var g,m,E=this;E.ready=function(){var e=o(arguments);if(m||(m={}),"ready"in m){if(m.ready===!0)return i(e)}else m.ready=[];return m.ready=m.ready.concat(e),E},E.tie=function(){var e,t=o(arguments),n="object"!=typeof t[0]||"nodeType"in t[0]?{}:t.shift(),r=l(t.length>0&&"object"==typeof t[t.length-1]&&!("nodeType"in t[t.length-1])?t.pop():{});t.length<=0&&t.push(document.body),n=p(n),"ties"in m||(m.ties=[]),m.ties.push({model:n,target:t.slice()});for(;t.length;)e=t.shift(),f(e).forEach(function(e){var t=e.nodeValue.substr(1,e.nodeValue.length-2).split(/:/),o=t.shift(),i=t.length?t.join(":"):"",a=d(n,o);a?a()||a(i):r.greedy&&(a=h(i,n),Object.defineProperty(n,o,{enumerable:!0,get:a,set:a})),a&&a.element(e)}),c(e).forEach(function(e){var t;document.body.contains(e)&&(t=g.parse(e.getAttribute(m.defaults.attribute)),"object"==typeof t&&Object.keys(t).forEach(function(r){var o=a(r);o(e,n,t[r],d)}))});return n},E.defaults=function(e){return e&&"object"==typeof e&&(m.defaults=l(e)),m.defaults},E.delegate=h,E.delegate.get=d,E.extension=a,E.ties=function(e){var t=[],n=[e];if("ties"in m){for(;n[n.length-1].parentNode;)n.push(n[n.length-1].parentNode);m.ties.forEach(function(e){var r=e.target.filter(function(e){return n.indexOf(e)>=0});r.length&&t.push(e.model)})}return t},n()}e.knot=new n}(this,function(e){e("attribute",function(e,t,n,r){"use strict";function o(t,n){n?e.setAttribute(t,n):e.removeAttribute(t)}Object.keys(n).forEach(function(i){var a=r(t,n[i]);a&&a.subscribe(function(t){e.getAttribute(i)!==t&&o(i,t)}),o(i,t[n[i]])})}),e("style",function(e,t,n,r){"use strict";Object.keys(n).forEach(function(o){var i,a=r(t,n[o]),u=function(t){var n;"classList"in e?e.classList[t?"add":"remove"](o):(i||(i=new RegExp("(?:^|\\s+)"+o+"(\\s+|$)")),n=e.className.replace(i,function(e,t){return t||""}),e.className=n+(t?" "+o:""))};a&&a.subscribe(u),u(t[n[o]])})}),e("text",function(e,t,n,r){"use strict";var o=r(t,n),i=e.firstChild&&3===e.firstChild.nodeType?e.firstChild:document.createTextNode(o?o():""),a=function(){i.parentNode!==e&&(e.firstChild?e.insertBefore(i,e.firstChild):e.appendChild(i))};o&&(o.subscribe(a),o.element(i)),a(t[n])}),e("each",function(e,t,n,r){"use strict";function o(e){var r;return["map","filter"].forEach(function(o){o in n&&(r=n[o]instanceof Array?n[o]:[n[o]],r.forEach(function(n){if("function"==typeof t[n])e=e[o](t[n]);else{if("function"!=typeof window[n])throw new Error(n+" is not a "+o+" function");e=e[o](window[n])}}))}),e}function i(){var r=document.createDocumentFragment(),i=[],u=t[a];for("object"==typeof n&&(u=o(u)),u.forEach(function(e,o){var a,u="object"==typeof e?e:{},s=[u];for(u.$item=e,u.$parent=t[n],u.$index=o,a=0;a<c.length;++a)s.push(r.appendChild(c[a].cloneNode(!0)));i.push(function(){knot.tie.apply(knot,s)})});e.lastChild;)e.removeChild(e.lastChild);e.appendChild(r),i.forEach(function(e){e()})}var a,u,c=[];if("object"==typeof n){if(a=n.target||!1,!a)throw new Error('Missing target for "each"')}else a=n;for(u=r(t,a);e.firstChild;)c.push(e.removeChild(e.firstChild).cloneNode(!0));u.subscribe(function(){i()}),i()}),e("event",function(e,t,n,r){"use strict";Object.keys(n).forEach(function(o){for(var i="string"==typeof n[o]?n[o].split("."):[],a=t;i.length;)i[0]in a&&(a=a[i[0]]),i.shift();e.addEventListener(o,function(e){"function"==typeof a?a.apply(t,[e,t,n[o]]):"object"!=typeof a||a[n[o]]instanceof Array||Object.keys(n[o]).forEach(function(e){var t=e in a?r(a,e):null;t&&t(n[o][e])})},!1)})}),e("input",function(e,t,n,r){function o(e){return"type"in e?e.type:/^select/i.test(e.nodeName)?"select-"+(e.multiple?"multiple":"one"):"text"}function i(t){return t in s||(s[t]={model:function(){c(e[t])},element:function(n){e[t]=n}}),s[t]}function a(){var o="default"in n?{value:null,label:n["default"]}:!1,i=function(){var r=0;"options"in n&&n.options in t&&(o&&(e.options[r]=new Option(o.label,o.value),++r),e.options.length=r,"object"==typeof t[n.options]&&(t[n.options]instanceof Array?t[n.options].forEach(function(t,n){"object"==typeof t?e.options[n+r]=new Option(t.label||t.value||"",t.value||""):e.options[n+r]=new Option(t)}):Object.keys(t[n.options]).forEach(function(o,i){e.options[i+r]=new Option(t[n.options][o],o)}))),e.options.length&&c&&c(e.options[e.selectedIndex].value)},a=function(t){var n;for(n=0;n<e.options.length;++n)t instanceof Array?e.options[n].selected=t.indexOf(e.options[n].value)>=0:e.options[n].selected=e.options[n].value===t},u="options"in n?r(t,n.options):!1,c="value"in n?r(t,n.value):!1,s=c?c():null;u&&u.subscribe(function(e){i()}),!c&&"value"in n&&(c=knot.delegate(e.hasAttribute("multiple")?[]:""),Object.defineProperty(t,n.value,{enumerable:!0,get:c,set:c})),c&&(s instanceof Array?e.setAttribute("multiple",""):e.removeAttribute("multiple"),e.addEventListener("change",function(t){e.options.length&&c(e.options[e.selectedIndex].value)},!1),c.subscribe(a)),(u||c)&&(i(),a(s))}var u,c,s={};switch(o(e)){case"checkbox":case"radio":u="checked";break;case"select":case"select-one":case"select-multiple":a();break;default:u="value"}u&&(c=r(t,n[u]),c&&(e.addEventListener("input",i(u).model,!1),e.addEventListener("change",i(u).model,!1),c.subscribe(i(u).element),e[u]=c()))})});
//# sourceMappingURL=knot.min.js.map